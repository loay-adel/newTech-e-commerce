"use client";

import { useEffect } from "react";
import { useSelector, useDispatch } from "react-redux";
import { setLanguage } from "@/lib/redux/slices/languageSlice";

const translations = {
  en: {
    brand_name: "ShopEase",
    loading: "Loading data...",
    errors: {
      fetch_products: "Error fetching products",
      fetch_products_message:
        "Something went wrong while loading the products.",
      product_not_found: "Product not found",
      network_error: "Network error. Please check your connection.",
      server_error: "Server error. Please try again later.",
      generic_error: "Something went wrong. Please try again.",
    },
    actions: {
      try_again: "Try again",
    },
    home: {
      hero: {
        title: "Latest technologies at unbeatable prices",
        subtitle:
          "Discover the latest screens, computers, and technical accessories with high quality and best prices",
        browse_products: "Browse Products",
        new_collection: "New Collection Available",
        learn_more: "Learn More",
      },
      featured: {
        title: "Featured Products",
        subtitle: "The most requested products by our customers",
        view_all: "View All Products",
        no_products: "No products available currently",
      },
      categories: {
        title: "Browse Categories",
        subtitle:
          "Discover our diverse products in various technical categories",
        products: "products",
        no_categories: "No categories available currently",
        explore: "Explore",
      },
      new_arrivals: {
        title: "New Arrivals",
        subtitle: "The latest products that arrived in our store",
        view_all: "View All Products",
        no_products: "No new products currently",
        new: "New",
      },
      scroll_indicator: "Scroll down",
      newsletter: {
        title: "Stay in the Loop",
        subtitle:
          "Get the latest updates on new products, exclusive deals, and special offers delivered straight to your inbox.",
        placeholder: "Enter your email address",
        subscribe: "Subscribe",
        privacy: "No spam, unsubscribe at any time. Privacy policy applies.",
      },
      stats: {
        title: "Our Achievements",
        products: "Products",
        customers: "Customers",
        rating: "Rating",
        support: "Support",
      },
    },
    products: {
      title: "All Products",
      show_filters: "Show Filters",
      hide_filters: "Hide Filters",
      search_placeholder: "Search products...",
      category: "Category",
      all_categories: "All Categories",
      sort_by: "Sort by",
      latest: "Latest",
      price_low_high: "Price: Low to High",
      price_high_low: "Price: High to Low",
      no_results: "No products match your search",
      filters: "filters",
      items_available: "items available",
      back: "back",
      categories: "categories",
      active_filters: "Active Filters",
      search: "Search",
      clear_filters: "Clear All Filters",
      no_results_title: "No Results Found",
      no_results_description: "Try adjusting your filters or search terms.",
    },
    categories: {
      pre_builds: "Pre Builds",
      new: "New",
      used: "Used",
      pc_parts: "PC Parts",
      memory: "Memory",
      storage: "Storage",
      accessories: "Accessories",
      keyboards: "Keyboards",
      mice: "Mice",
      headphones: "Headphones",
      gaming_accessories: "Gaming Accessories",
      adapters: "Adapters/Converters",
      speakers: "Speakers",
      webcams: "Webcams",
      networking: "Networking",
      power: "Power",
      cleaning: "Cleaning",
    },
    aria_labels: {
      toggle_menu: "Toggle menu",
      search: "Search",
      cart: "Cart",
      account: "Account",
      toggle_theme: "Toggle theme",
      close_search: "Close search",
      close: "Close",
    },
    account: {
      my_account: "My Account",
      orders: "Orders",
      sign_out: "Sign out",
      sign_in: "Sign in",
      sign_up: "Sign up",
      preferences: "Preferences",
      newsletter: "Subscribe to newsletter",
      email_notifications: "Email notifications",
      sms_notifications: "SMS notifications",
      welcome: "Welcome back",
      profile: "Profile",
      settings: "Settings",
    },
    theme: {
      light: "Light",
      dark: "Dark",
      theme: "Theme",
      system: "System",
    },
    language: "Language",
    search: {
      placeholder: "Search products...",
      recent: "Recent searches",
      popular: "Popular searches",
      no_results: "No results found",
    },
    product: {
      no_image: "No image available",
      reviews: "reviews",
      add_to_cart: "Add to Cart",
      category: "Category",
      availability: "Availability",
      in_stock: "In Stock",
      out_of_stock: "Out of Stock",
      low_stock: "Low Stock",
      sku: "SKU",
      save_percent: "Save {{percent}}%",
      recommended: "Recommended Products",
      description: "Description",
      brand: "Brand",
      added_to_cart: "Added to cart",
      in_cart: "In Cart",
      highlights: "Product Highlights",
      details: "Product Details",
      premium_quality: "Premium quality materials",
      brand_placeholder: "Generic Brand",
      weight: "Weight",
      free_shipping: "Free Shipping",
      free_shipping_details: "Free shipping on orders over $50",
      ships_in: "Ships in",
      days: "days",
      save_amount: "You save ${{amount}}",
      write_review: "Write a review",
      view_all: "View All",
      specifications: "Specifications",
      features: "Features",
    },
    wishlist: {
      title: "My Wishlist",
      added: "Added to wishlist",
      removed: "Removed from wishlist",
      empty: "Your wishlist is empty",
      items: "items",
      move_to_cart: "Move to Cart",
      remove: "Remove",
    },
    actions: {
      try_again: "Try again",
      back_to_home: "Back to Home",
      back_to_products: "Back to Products",
      continue_shopping: "Continue Shopping",
      proceed_to_checkout: "Proceed to Checkout",
      add: "Add New",
      apply: "Apply",
      cancel: "Cancel",
      confirm: "Confirm",
      save: "Save",
      edit: "Edit",
      delete: "Delete",
    },
    currency: "EGP",
    price_prefix: "EGP",
    about: {
      title: "About Us",
      content:
        "We are a tech store passionate about bringing you the latest gadgets and electronics at competitive prices. Our team of experts carefully selects each product to ensure quality and value.",
      team: "Our Team",
      mission: "Our Mission",
      vision: "Our Vision",
      values: "Our Values",
    },
    contact: {
      title: "Contact Us",
      subtitle: "We'd love to hear from you",
      form: {
        name: "Your Name",
        email: "Email Address",
        phone: "Phone Number",
        message: "Your Message",
        submit: "Send Message",
        success: "Thank you! Your message has been sent.",
      },
      info: {
        address: "123 Tech Street, Cairo, Egypt",
        phone: "+20 123 456 7890",
        email: "info@shopease.com",
        hours: "Sunday-Thursday: 9AM-5PM",
      },
    },
    cart: {
      title: "Shopping Cart",
      items: "Cart items",
      clear_cart: "Clear cart",
      total: "Total",
      subtotal: "Subtotal",
      shipping: "Shipping",
      order_summary: "Order Summary",
      continue_shopping: "Continue shopping",
      empty: "Your cart is empty",
      free: "Free",
      checkout: "Checkout",
      quantity: "Quantity",
      remove: "Remove",
      apply_coupon: "Apply coupon",
      coupon_code: "Coupon code",
    },
    checkout: {
      title: "Complete Your Order",
      shipping_info: "Shipping Information",
      shipping_location: "Governorate",
      default_address: "Set as default address",
      default: "Default",
      first_name: "First Name",
      last_name: "Last Name",
      email: "Email",
      phone: "Phone",
      address: "Address",
      city: "City",
      state: "State/Province",
      zip: "ZIP/Postal Code",
      payment_method: "Payment Method",
      credit_card: "Credit Card",
      card_number: "Card Number",
      expiry_date: "Expiry Date",
      cvv: "CVV",
      card_name: "Name on Card",
      card_name_placeholder: "As shown on card",
      cash_on_delivery: "Cash on Delivery",
      order_summary: "Order Summary",
      place_order: "Place Order",
      success: "Order placed successfully!",
      error: "Failed to place order. Please try again.",

      credit_card_description: "Pay securely with your credit card",
      cash_on_delivery_description: "Pay with cash upon delivery",
      select_city: "Select your city",
      subtotal: "Subtotal",
      shipping: "Shipping",
      total: "Total",
      area: "Area",
      postal_code: "Postal Code",
      landmark: "Landmark",
      shipping_location: "Governorate",
      validation: {
        required: "This field is required",
        invalid_email: "Please enter a valid email",
        invalid_phone: "Please enter a valid phone number",
        invalid_zip: "Please enter a valid ZIP code",
        too_short: "This field is too short",
      },
    },
    auth: {
      signup: {
        title: "Create a new account",
        subtitle: "Fill in your information to register",
        full_name: "Full Name",
        phone: "Phone Number",
        governorate: "Governorate",
        choose_governorate: "Choose Governorate",
        city: "City",
        postal_code: "Postal Code",
        address: "Street Address",
        confirm_password: "Confirm Password",
        agree_terms: "I agree to the terms and conditions",
        loading: "Creating account...",
        button: "Sign Up",
        already_account: "Already have an account?",
        signin: "Sign In",
        success: "Account created successfully!",
        error: "Failed to create account. Please try again.",
        already_logged_in: "You are already logged in",
        go_home: "Go Home",
        personal_info: "Personal Information",
        address_info: "Address Information",
        security_info: "Security Information",
        validation: {
          name_required: "Full name is required",
          email_required: "Email is required",
          email_invalid: "Please enter a valid email address",
          phone_required: "Phone number is required",
          phone_invalid: "Please enter a valid Egyptian phone number",
          governorate_required: "Governorate is required",
          city_required: "City is required",
          postal_code_required: "Postal code is required",
          address_required: "Address is required",
          password_required: "Password is required",
          password_length: "Password must be at least 6 characters",
          password_mismatch: "Passwords do not match",
          terms: "You must agree to the terms and conditions",
        },
        refreshing_token: "Refreshing session...",
      },
      signin: {
        title: "Sign in to your account",
        subtitle: "Enter your credentials to access your account",
        email: "Email",
        password: "Password",
        loading: "Signing in...",
        button: "Sign In",
        no_account: "Don't have an account?",
        please_login: "Please login to view your account",
        create_account: "Create Account",
        success: "Signed in successfully!",
        error: "Failed to sign in. Please try again.",
        already_logged_in: "You are already logged in",
        go_home: "Go Home",
        validation: {
          fill_fields: "Please fill in all fields",
        },
      },
    },
    notifications: {
      success: "Success",
      error: "Error",
      warning: "Warning",
      info: "Information",
    },
    form: {
      optional: "Optional",
      required: "Required",
      submitting: "Submitting...",
    },
    filters: {
      price_range: "Price Range",
      rating: "Rating",
      brand: "Brand",
      condition: "Condition",
      new: "New",
      used: "Used",
      refurbished: "Refurbished",
    },
    sort: {
      relevance: "Relevance",
      popularity: "Popularity",
      rating: "Rating",
      newest: "Newest",
      price_low_high: "Price: Low to High",
      price_high_low: "Price: High to Low",
    },
  },
  ar: {
    brand_name: "متجر تِك",
    loading: "جاري تحميل البيانات...",
    errors: {
      fetch_products: "حدث خطأ أثناء جلب المنتجات",
      fetch_products_message: "حدث خطأ أثناء تحميل المنتجات.",
      product_not_found: "المنتج غير موجود",
      network_error: "خطأ في الشبكة. يرجى التحقق من اتصالك.",
      server_error: "خطأ في الخادم. يرجى المحاولة مرة أخرى لاحقاً.",
      generic_error: "حدث خطأ ما. يرجى المحاولة مرة أخرى.",
    },
    actions: {
      try_again: "حاول مرة أخرى",
    },
    home: {
      hero: {
        title: "أحدث التقنيات بأسعار لا تقبل المنافسة",
        subtitle:
          "اكتشف أحدث الشاشات، أجهزة الكمبيوتر، والاكسسوارات التقنية بجودة عالية وأفضل الأسعار",
        browse_products: "تصفح المنتجات",
        new_collection: "المجموعة الجديدة متاحة",
        learn_more: "تعرف على المزيد",
      },
      featured: {
        title: "المنتجات المميزة",
        subtitle: "أفضل المنتجات الأكثر طلباً من عملائنا",
        view_all: "عرض جميع المنتجات",
        no_products: "لا توجد منتجات متاحة حالياً",
      },
      categories: {
        title: "تصفح الفئات",
        subtitle: "اكتشف منتجاتنا المتنوعة في مختلف الفئات التقنية",
        products: "منتج",
        no_categories: "لا توجد فئات متاحة حالياً",
        explore: "استكشف",
      },
      new_arrivals: {
        title: "وصل حديثاً",
        subtitle: "أحدث المنتجات التي وصلت لمتجرنا",
        view_all: "عرض جميع المنتجات",
        no_products: "لا توجد منتجات جديدة حالياً",
        new: "جديد",
      },
      scroll_indicator: "التمرير للأسفل",
      newsletter: {
        title: "ابقَ على اطلاع",
        subtitle:
          "احصل على آخر التحديثات حول المنتجات الجديدة، العروض الحصرية، والعروض الخاصة مباشرة إلى بريدك الإلكتروني.",
        placeholder: "أدخل عنوان بريدك الإلكتروني",
        subscribe: "اشترك",
        privacy:
          "لا رسائل مزعجة، يمكنك إلغاء الاشتراك في أي وقت. تطبق سياسة الخصوصية.",
      },
      stats: {
        title: "إنجازاتنا",
        products: "المنتجات",
        customers: "العملاء",
        rating: "التقييم",
        support: "الدعم",
      },
    },
    products: {
      title: "جميع المنتجات",
      show_filters: "عرض الفلاتر",
      hide_filters: "إخفاء الفلاتر",
      search_placeholder: "ابحث عن المنتجات...",
      category: "الفئة",
      all_categories: "كل الفئات",
      sort_by: "ترتيب حسب",
      latest: "الأحدث",
      price_low_high: "السعر: من الأقل للأعلى",
      price_high_low: "السعر: من الأعلى للأقل",
      no_results: "لا توجد منتجات مطابقة لبحثك",
      filters: "فلاتر",
      items_available: "المنتجات المتاحة",
      back: "الرجوع",
      categories: "فئات",
      active_filters: "الفلاتر المفعّلة",
      search: "بحث",
      clear_filters: "مسح جميع الفلاتر",
      no_results_title: "لا توجد نتائج",
      no_results_description: "حاول تعديل الفلاتر أو كلمات البحث.",
    },
    categories: {
      pre_builds: "أجهزة مسبقة التجميع",
      new: "جديد",
      used: "مستعمل",
      pc_parts: "قطع الكمبيوتر",
      memory: "الذاكرة",
      storage: "التخزين",
      accessories: "ملحقات",
      keyboards: "لوحات المفاتيح",
      mice: "الفأرة",
      headphones: "سماعات الرأس",
      gaming_accessories: "ملحقات الألعاب",
      adapters: "المحولات",
      speakers: "مكبرات الصوت",
      webcams: "كاميرات الويب",
      networking: "الشبكات",
      power: "الطاقة",
      cleaning: "التنظيف",
    },
    aria_labels: {
      toggle_menu: "تبديل القائمة",
      search: "بحث",
      cart: "عربة التسوق",
      account: "الحساب",
      toggle_theme: "تبديل السمة",
      close_search: "إغلاق البحث",
      close: "إغلاق",
    },
    account: {
      my_account: "حسابي",
      orders: "الطلبات",
      preferences: "التفضيلات",
      newsletter: "الاشتراك في النشرة البريدية",
      email_notifications: "إشعارات البريد الإلكتروني",
      sms_notifications: "إشعارات الرسائل القصيرة",
      sign_out: "تسجيل خروج",
      sign_in: "تسجيل دخول",
      sign_up: "تسجيل",
      welcome: "مرحباً بعودتك",
      profile: "الملف الشخصي",
      settings: "الإعدادات",
    },
    theme: {
      light: "فاتح",
      dark: "داكن",
      theme: "السمة",
      system: "النظام",
    },
    language: "اللغة",
    search: {
      placeholder: "ابحث عن المنتجات...",
      recent: "عمليات البحث الحديثة",
      popular: "عمليات البحث الشائعة",
      no_results: "لم يتم العثور على نتائج",
    },
    product: {
      no_image: "لا توجد صورة متاحة",
      reviews: "تقييمات",
      add_to_cart: "أضف إلى السلة",
      category: "الفئة",
      availability: "التوفر",
      in_stock: "متوفر",
      out_of_stock: "غير متوفر",
      low_stock: "كمية محدودة",
      sku: "رمز المنتج",
      save_percent: "وفر {{percent}}%",
      recommended: "منتجات مقترحة",
      description: "وصف المنتج",
      brand: "ماركة",
      added_to_cart: "تمت الإضافة إلى السلة",
      in_cart: "في السلة",
      highlights: "أبرز المميزات",
      details: "تفاصيل المنتج",
      premium_quality: "مواد عالية الجودة",
      brand_placeholder: "ماركة عامة",
      weight: "الوزن",
      free_shipping: "شحن مجاني",
      free_shipping_details: "شحن مجاني للطلبات فوق 50 دولار",
      ships_in: "التوصيل خلال",
      days: "أيام",
      save_amount: "وفرت ${{amount}}",
      write_review: "اكتب تقييمك",
      view_all: "عرض الكل",
      specifications: "المواصفات",
      features: "المميزات",
    },
    wishlist: {
      title: "قائمة الرغبات",
      added: "تمت الإضافة إلى المفضلة",
      removed: "تمت الإزالة من المفضلة",
      empty: "قائمة الرغبات فارغة",
      items: "منتجات",
      move_to_cart: "نقل إلى السلة",
      remove: "إزالة",
    },
    actions: {
      try_again: "حاول مرة أخرى",
      back_to_home: "العودة إلى الصفحة الرئيسية",
      back_to_products: "العودة إلى المنتجات",
      continue_shopping: "مواصلة التسوق",
      proceed_to_checkout: "المتابعة إلى الدفع",
      apply: "تطبيق",
      cancel: "إلغاء",
      confirm: "تأكيد",
      add: "إضافة جديد",
      save: "حفظ",
      edit: "تعديل",
      delete: "حذف",
    },
    currency: "جنيه",
    price_prefix: "ج.م",
    about: {
      title: "من نحن",
      content:
        "نحن متجر تقني نحرص على توفير أحدث الأجهزة والإلكترونيات بأسعار تنافسية. يقوم فريقنا من الخبراء باختيار كل منتج بعناية لضمان الجودة والقيمة.",
      team: "فريقنا",
      mission: "مهمتنا",
      vision: "رؤيتنا",
      values: "قيمنا",
    },
    contact: {
      title: "اتصل بنا",
      subtitle: "نحن نرحب بتواصلك معنا",
      form: {
        name: "اسمك",
        email: "البريد الإلكتروني",
        phone: "رقم الهاتف",
        message: "رسالتك",
        submit: "إرسال الرسالة",
        success: "شكراً لك! تم إرسال رسالتك بنجاح.",
      },
      info: {
        address: "123 شارع التقنية، القاهرة، مصر",
        phone: "+20 123 456 7890",
        email: "info@shopease.com",
        hours: "الأحد-الخميس: 9ص-5م",
      },
    },
    cart: {
      title: "سلة التسوق",
      items: "عناصر السلة",
      clear_cart: "إفراغ السلة",
      total: "الإجمالي",
      subtotal: "المجموع الفرعي",
      shipping: "الشحن",
      order_summary: "ملخص الطلب",
      continue_shopping: "متابعة التسوق",
      empty: "سلة التسوق فارغة",
      free: "مجاني",
      checkout: "الدفع",
      quantity: "الكمية",
      remove: "إزالة",
      apply_coupon: "تطبيق كوبون",
      coupon_code: "رمز الكوبون",
    },
    checkout: {
      title: "إتمام الطلب",
      shipping_info: "معلومات الشحن",
      first_name: "الاسم الأول",
      last_name: "اسم العائلة",
      email: "البريد الإلكتروني",
      phone: "رقم الهاتف",
      address: "العنوان",
      city: "المدينة",
      state: "المنطقة/المحافظة",
      zip: "الرمز البريدي",
      payment_method: "طريقة الدفع",
      credit_card: "بطاقة ائتمانية",
      card_number: "رقم البطاقة",
      expiry_date: "تاريخ الانتهاء",
      cvv: "CVV",
      card_name: "اسم صاحب البطاقة",
      card_name_placeholder: "كما هو مدون على البطاقة",
      cash_on_delivery: "الدفع عند الاستلام",
      order_summary: "ملخص الطلب",
      place_order: "تأكيد الطلب",
      success: "تم تقديم الطلب بنجاح!",
      error: "فشل تقديم الطلب. يرجى المحاولة مرة أخرى.",
      credit_card_description: "ادفع بأمان باستخدام بطاقتك الائتمانية",
      cash_on_delivery_description: "ادفع نقدًا عند الاستلام",
      select_city: "اختر مدينتك",
      subtotal: "المجموع الفرعي",
      shipping: "الشحن",
      total: "الاجمالي",
      area: "المنطقة",
      postal_code: "الرمز البريدي",
      landmark: "علامة مميزة",
      shipping_location: "المحافظة",
      default_address: "اجعل العنوان افتراضي",
      default: "افتراضي",
      validation: {
        required: "هذا الحقل مطلوب",
        invalid_email: "يرجى إدخال بريد إلكتروني صحيح",
        invalid_phone: "يرجى إدخال رقم هاتف صحيح",
        invalid_zip: "يرجى إدخال رمز بريدي صحيح",
        too_short: "هذا الحقل قصير جداً",
      },
    },
    auth: {
      signup: {
        title: "إنشاء حساب جديد",
        subtitle: "املأ بياناتك للتسجيل",
        full_name: "الاسم الكامل",
        phone: "رقم الهاتف",
        governorate: "المحافظة",
        choose_governorate: "اختر المحافظة",
        city: "المدينة",
        postal_code: "الرمز البريدي",
        address: "عنوان الشارع",
        confirm_password: "تأكيد كلمة المرور",
        agree_terms: "أوافق على الشروط والأحكام",
        loading: "جاري إنشاء الحساب...",
        button: "تسجيل",
        already_account: "لديك حساب بالفعل؟",
        signin: "تسجيل الدخول",
        success: "تم إنشاء الحساب بنجاح!",
        error: "فشل في إنشاء الحساب. يرجى المحاولة مرة أخرى.",
        already_logged_in: "أنت مسجل دخول بالفعل",
        go_home: "الذهاب للرئيسية",
        personal_info: "المعلومات الشخصية",
        address_info: "معلومات العنوان",
        security_info: "معلومات الأمان",
        validation: {
          name_required: "الاسم الكامل مطلوب",
          email_required: "البريد الإلكتروني مطلوب",
          email_invalid: "يرجى إدخال بريد إلكتروني صالح",
          phone_required: "رقم الهاتف مطلوب",
          phone_invalid: "يرجى إدخال رقم هاتف مصري صحيح",
          governorate_required: "المحافظة مطلوبة",
          city_required: "المدينة مطلوبة",
          postal_code_required: "الرمز البريدي مطلوب",
          address_required: "العنوان مطلوب",
          password_required: "كلمة المرور مطلوبة",
          password_length: "يجب أن تتكون كلمة المرور من 6 أحرف على الأقل",
          password_mismatch: "كلمتا المرور غير متطابقتان",
          terms: "يجب أن توافق على الشروط والأحكام",
        },
        refreshing_token: "يتم تحديث الجلسة...",
      },
      signin: {
        title: "تسجيل الدخول إلى حسابك",
        subtitle: "أدخل بياناتك للوصول إلى حسابك",
        email: "البريد الإلكتروني",
        password: "كلمة المرور",
        loading: "جاري تسجيل الدخول...",
        button: "تسجيل الدخول",
        no_account: "ليس لديك حساب؟",
        create_account: "إنشاء حساب",
        success: "تم تسجيل الدخول بنجاح!",
        error: "فشل تسجيل الدخول. يرجى المحاولة مرة أخرى.",
        already_logged_in: "أنت مسجل دخول بالفعل",
        go_home: "الذهاب للرئيسية",
        please_login: "من فضلك قم بتسجيل الدخول لعرض حسابك",
        validation: {
          fill_fields: "يرجى ملء جميع الحقول",
        },
      },
    },
    notifications: {
      success: "تم بنجاح",
      error: "خطأ",
      warning: "تحذير",
      info: "معلومة",
    },
    form: {
      optional: "اختياري",
      required: "مطلوب",
      submitting: "جاري الإرسال...",
    },
    filters: {
      price_range: "نطاق السعر",
      rating: "التقييم",
      brand: "الماركة",
      condition: "الحالة",
      new: "جديد",
      used: "مستعمل",
      refurbished: "مجدّد",
    },
    sort: {
      relevance: "الأكثر صلة",
      popularity: "الأكثر شيوعاً",
      rating: "التقييم",
      newest: "الأحدث",
      price_low_high: "السعر: من الأقل للأعلى",
      price_high_low: "السعر: من الأعلى للأقل",
    },
  },
};

export const useTranslation = () => {
  const dispatch = useDispatch();
  const { currentLanguage, isRTL } = useSelector((state) => state.language);

  useEffect(() => {
    // Only run on client side
    if (typeof window !== "undefined") {
      const savedLang = localStorage.getItem("language");
      const browserLang = navigator.language?.split("-")[0].toLowerCase();

      // Set initial language
      const initialLang =
        savedLang && translations[savedLang]
          ? savedLang
          : translations[browserLang]
          ? browserLang
          : "en";

      dispatch(setLanguage(initialLang));
      document.documentElement.lang = initialLang;
      document.documentElement.dir = initialLang === "ar" ? "rtl" : "ltr";
    }
  }, [dispatch]);

  const changeLanguage = (lang) => {
    if (translations[lang]) {
      dispatch(setLanguage(lang));
      document.documentElement.lang = lang;
      document.documentElement.dir = lang === "ar" ? "rtl" : "ltr";
      localStorage.setItem("language", lang);
    }
  };

  const t = (key, params = {}) => {
    const keys = key.split(".");
    let value = translations[currentLanguage];

    for (const k of keys) {
      value = value?.[k];
      if (value === undefined) return key;
    }

    // Handle dynamic parameters in translations
    if (typeof value === "string" && params) {
      return Object.keys(params).reduce((str, param) => {
        return str.replace(new RegExp(`{{${param}}}`, "g"), params[param]);
      }, value);
    }

    return value;
  };

  return { t, changeLanguage, currentLanguage, isRTL };
};
